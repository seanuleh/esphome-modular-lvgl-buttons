esphome:
  name: "ir-project"

esp32:
  board: esp32dev
  framework:
    type: arduino

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password
  ap:
    ssid: "ir-hub-ap"
    channel: 10

captive_portal:
logger:
  level: VERBOSE
api:
ota:
  platform: esphome

# ESP-NOW is native in ESPHome 2025.8.0+
espnow:
  channel: 10
  auto_add_peer: true
  peers:
    - "A0:76:4E:76:B5:B8"  # C3 Remote
  on_receive:
    - if:
        condition:
          lambda: |-
            const uint8_t expected[6] = {0xA0, 0x76, 0x4E, 0x76, 0xB5, 0xB8};
            return memcmp(info.src_addr, expected, 6) == 0;
        then:
          - logger.log: "ESP-NOW received from C3 remote"
          - button.press: ac_power_button
        else:
          - logger.log:
              format: "ESP-NOW from unknown: %s"
              args:
                - format_mac_address_pretty(info.src_addr).c_str()

remote_receiver:
  pin:
    number: GPIO14
    inverted: true
  dump: raw

remote_transmitter:
  pin: GPIO4
  carrier_duty_percent: 50%
  non_blocking: true

button:
  - platform: template
    id: ac_power_button
    name: "Master Bedroom AC Power Button"
    icon: "mdi:air-conditioner"
    on_press:
      - remote_transmitter.transmit_raw:
          carrier_frequency: 38kHz
          code: [3422, -1648, 452, -1229, 451, -1232, 447, -395, 444, -397, 444, -397, 443, -1239, 443, -398, 442, -398, 443, -1239, 443, -1238, 443, -398, 443, -1239, 442, -398, 443, -398, 442, -1239, 443, -1239, 443, -398, 442, -1239, 443, -1239, 442, -399, 442, -398, 442, -1240, 442, -399, 442, -399, 441, -1240, 442, -399, 442, -399, 441, -399, 443, -399, 441, -399, 442, -398, 442, -400, 441, -399, 442, -423, 417, -399, 442, -399, 442, -423, 418, -399, 441, -423, 418, -400, 441, -9083, 3386, -1682, 417, -1264, 418, -1264, 418, -422, 418, -423, 418, -423, 417, -1264, 418, -423, 418, -423, 418, -1263, 418, -1264, 417, -423, 418, -1264, 418, -423, 417, -423, 418, -1264, 417, -1264, 418, -423, 418, -1264, 417, -1264, 418, -423, 417, -424, 417, -1264, 417, -423, 418, -423, 418, -1264, 418, -423, 417, -423, 418, -423, 418, -423, 418, -423, 417, -423, 418, -423, 418, -423, 418, -423, 417, -423, 418, -423, 418, -423, 417, -423, 418, -423, 417, -424, 417, -424, 417, -424, 417, -423, 418, -423, 417, -424, 417, -1264, 418, -423, 417, -423, 418, -423, 418, -423, 417, -423, 418, -1264, 417, -1264, 418, -424, 417, -423, 417, -424, 417, -423, 418, -423, 417, -424, 417, -424, 417, -423, 417, -424, 417, -424, 417, -424, 417, -424, 417, -1264, 417, -1265, 417, -423, 418, -1264, 417, -423, 417, -424, 417, -424, 418, -1264, 417, -423, 417, -1265, 417, -1265, 416, -1265, 417, -1264, 417, -1265, 417, -423, 418, -1264, 417, -1264, 418, -1264, 417, -424, 416, -424, 417, -1265, 417, -1265, 416, -424, 418, -423, 417, -424, 417, -424, 416, -424, 417, -424, 417, -424, 417, -424, 416, -424, 417, -424, 417, -424, 416, -424, 417, -424, 417, -424, 416, -424, 417, -424, 417, -424, 416, -424, 417, -425, 416, -424, 417, -424, 417, -424, 416, -425, 416, -424, 416, -425, 416, -425, 416, -1265, 417, -424, 416, -425, 416, -424, 417, -424, 417, -424, 416, -1265, 417, -424, 416, -425, 416, -424, 416, -426, 416, -424, 416, -425, 416, -425, 416, -425, 416, -424, 416, -424, 417, -424, 417, -424, 416, -425, 416, -425, 416, -424, 416, -425, 416, -1266, 416, -424, 393, -448, 393, -1289, 415, -425, 393, -448, 393, -1289, 393, -1288, 393]